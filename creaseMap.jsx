///////////////////////////////////////////////////////////////////////////////// CreaseMap// Evan Harper// Creates a creasemap based on currently open normal map.// Looks at currently open doc, copies red, green channels of current layer// to new doc. Runs Emboss on said layers, overlaying topmost, creating a b/w creasemap// Thanks to Seneca Menard for fakeCrazy algorithm///////////////////////////////////////////////////////////////////////////////creaseMap();///////////////////////////////////////////////////////////////////////////////// Function: creaseMap// Usage: the core routine for this script// Input: <none>// Return: <none>///////////////////////////////////////////////////////////////////////////////function creaseMap() {	// This will change to user values, just use defaults for now	var GREENDIR = -90;	var REDDIR = 0;	var EMBHEIGHT = 3;	var EMBAMT = 100;		//get current doc, modify or set for output	var originalDoc = app.activeDocument;		// check the dimensions of our current doc	var originalWidth = originalDoc.width;	var originalHeight = originalDoc.height;		var fixedDoc = app.documents.add(originalDoc.width, originalDoc.height, 72, "newDoc", NewDocumentMode.RGB, DocumentFill.TRANSPARENT);	app.activeDocument = originalDoc;	var savedActiveChannels = originalDoc.activeChannels;	var myChannels = originalDoc.channels		//Go through all the channels, activating one at a time and copying to new document	for (var channelIndex = 0; channelIndex < myChannels.length; channelIndex++) {		//make channel visible, 		myChannels[channelIndex].visible= true		var aChannelArray = new Array();		aChannelArray[0] = myChannels[channelIndex];		originalDoc.activeChannels = aChannelArray;		// turn off all the other channels		for (var secondaryIndex = 0; secondaryIndex < myChannels.length;		secondaryIndex++) {			if (channelIndex != secondaryIndex) {				myChannels[secondaryIndex].visible= false			}		}		// copy red and green channels to new doc, emboss based on channel name, config		if (myChannels[channelIndex].name == "Red" || myChannels[channelIndex].name == "Green") {			originalDoc.selection.selectAll();			originalDoc.selection.copy();			app.activeDocument = fixedDoc;			fixedDoc.selection.selectAll();			newLayer = fixedDoc.paste();			newLayer.name = myChannels[channelIndex].name;			if (myChannels[channelIndex].name == "Green") {				emboss(GREENDIR, EMBHEIGHT, EMBAMT);				newLayer.blendMode = BlendMode.OVERLAY;			}						if (myChannels[channelIndex].name == "Red" ){				emboss(REDDIR, EMBHEIGHT, EMBAMT);			}			app.activeDocument = originalDoc;		}	}	// Flatten new few and rename remaining layer to CreaseMap	app.activeDocument = fixedDoc;	fixedDoc.mergeVisibleLayers();	fixedDoc.activeLayer.name = "CreaswMap";	app.activeDocument = originalDoc;	originalDoc.activeChannels = savedActiveChannels;}//Run Emboss w/ vars... WTF Adobe.function emboss(angle, height, amount ){	var id32 = charIDToTypeID( "Embs" );	var desc7 = new ActionDescriptor();	var id33 = charIDToTypeID( "Angl" );	desc7.putInteger( id33, angle );	var id34 = charIDToTypeID( "Hght" );	desc7.putInteger( id34, height );	var id35 = charIDToTypeID( "Amnt" );	desc7.putInteger( id35, amount );	executeAction( id32, desc7,DialogModes.NO );}